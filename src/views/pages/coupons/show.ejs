<section>
  <div class="bg-white rounded shadow-sm p-4 my-3">
    <div class="d-flex gap-3">
      <div class="col">
        <h5><span class="fw-bold">Coupon Name:</span>
          <%= "Contoh Coupon" %>
        </h5>
      </div>
      <div class="mt-3">
        <button id="deleteBtn" class="btn btn-danger btn-sm">
          <i class="bi bi-trash"></i>
          Delete
        </button>
        <button class="btn btn-warning btn-sm" data-bs-toggle="modal" data-bs-target="#updateModal">
          <i class="bi bi-pencil-square"></i>
          Update
        </button>
      </div>
    </div>

  </div>

  <div class="modal fade" id="updateModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Update Coupon</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>

        <form id="formEdit" action="/admin/coupons/edit/<%= " contoh-coupon" %>">
          <div class="modal-body">
            <div class="form-floating mb-3">
              <input name="coupon_name" value="<%= " contoh-coupon" %>" type="text" class="form-control"
              placeholder="Name" autocomplete="off" required>
              <label>Coupon Name</label>
            </div>
          </div>
          <div class="modal-footer">
            <button type="submit" class="btn btn-md btn-success">Update</button>
          </div>
        </form>

      </div>
    </div>
  </div>

</section>

<script>
  $('#deleteBtn').on('click', function () {
    swal({
      title: "Are you sure?",
      text: '<%= "Contoh Coupon" %> will be deleted', icon: "warning", buttons: true, dangerMode: true,
    }).then((confirm) => {
      if (confirm) {
        $.ajax({
          url: 'http://localhost:3000/admin/coupons/delete/<%= "contoh-coupon" %>',
          type: 'DELETE',
          success: function (result) {
            swal({
              title: 'Success!',
              text: 'Coupon Deleted',
              icon: 'success',
            }).then((result) => {
              window.location.href = '/admin/coupons'
            })
          },
          error: function (err) {
            swal({
              title: 'Error!',
              text: 'An error occured',
              icon: 'error'
            })
          }
        })
      }
    })
  })

  $('#formEdit').on('submit', function (e) {
    e.preventDefault()
    $.ajax({
      url: $(this).attr('action'),
      type: 'PUT',
      data: $(this).serialize(),
      success: function (result) {
        swal({
          title: 'Success!',
          text: 'Coupon Updated',
          icon: 'success',
        }).then((result) => {
          window.location.href = '/admin/coupons/show/<%= "contoh-coupon" %>'
        })
      },
      error: function (err) {
        swal({
          title: 'Error!',
          text: 'An error occured',
          icon: 'error'
        })
      }
    })
  })

</script>